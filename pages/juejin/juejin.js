import { dataRequest } from '/utils/request.js';

Page({
  data: {
    entrylist: [
{
    "author": "",
    "autoPass": true,
    "buildTime": 1553263300.1597,
    "category":
    {
        "id": "5562b415e4b00c57d9b94ac8",
        "name": "前端",
        "ngxCached": true,
        "ngxCachedTime": 1553263447,
        "title": "frontend"
    },
    "checkStatus": true,
    "collectionCount": 2,
    "commentsCount": 0,
    "content": "直接上代码。",
    "createdAt": "2019-03-22T10:07:47.299Z",
    "english": false,
    "entryView": "",
    "gfw": false,
    "hot": false,
    "hotIndex": 130.0942,
    "isCollected": false,
    "isEvent": false,
    "lastCommentTime": "1970-01-01T00:00:00.Z",
    "ngxCachedTime": 1553263538,
    "objectId": "5c94b3f35188252d5f0fda60",
    "original": true,
    "originalUrl": "https://juejin.im/post/5c94b36851882556dc4bea80",
    "rankIndex": 5.23872030139,
    "screenshot": "",
    "subscribersCount": 0,
    "summaryInfo": "",
    "tags": [
    {
        "id": "5c3ffb726fb9a02c78db98c3",
        "ngxCached": true,
        "ngxCachedTime": 1553263474,
        "title": "数据结构"
    }],
    "title": "JS数据结构-栈-练习",
    "type": "post",
    "updatedAt": "2019-03-22T14:01:40.158Z",
    "user":
    {
        "avatarLarge": "https://user-gold-cdn.xitu.io/2018/11/28/1675af8c1f899c51?w=1234&h=1198&f=png&s=638830",
        "collectedEntriesCount": 62,
        "community": null,
        "company": "深圳跳槽中",
        "followeesCount": 33,
        "followersCount": 5431,
        "isAuthor": true,
        "jobTitle": "程序员",
        "ngxCached": true,
        "ngxCachedTime": 1553263487,
        "objectId": "56cc841dc4c9710057e04623",
        "postedEntriesCount": 39,
        "postedPostsCount": 25,
        "role": "editor",
        "subscribedTagsCount": 112,
        "totalCollectionsCount": 4838,
        "totalCommentsCount": 135,
        "username": "小诺哥",
        "viewedEntriesCount": 2263
    },
    "verifyCreatedAt": "2019-03-22T10:07:47.299Z",
    "verifyStatus": true,
    "viewsCount": 108
},
{
    "author": "",
    "autoPass": true,
    "buildTime": 1553263533.8162,
    "category":
    {
        "id": "5562b415e4b00c57d9b94ac8",
        "name": "前端",
        "ngxCached": true,
        "ngxCachedTime": 1553263447,
        "title": "frontend"
    },
    "checkStatus": true,
    "collectionCount": 29,
    "commentsCount": 8,
    "content": "",
    "createdAt": "2019-03-22T09:39:08.828Z",
    "english": false,
    "entryView": "",
    "gfw": false,
    "hot": false,
    "hotIndex": 1617.7487,
    "isCollected": false,
    "isEvent": false,
    "lastCommentTime": "2019-03-22T21:45:00.792Z",
    "ngxCachedTime": 1553263538,
    "objectId": "5c94ad3cf265da611459baed",
    "original": true,
    "originalUrl": "https://juejin.im/post/5c9482d86fb9a070f77d0eff",
    "rankIndex": 57.104560804601,
    "screenshot": "",
    "subscribersCount": 0,
    "summaryInfo": "地址：https://mp.weixin.qq.com/s/3BN6J1zSfYLhro4_cMrQhQ 地址：https://blog.fundebug.com/2019/03/20/understand-javascript-context-and-stack/ 地址：https://www....",
    "tags": [
    {
        "id": "55964d83e4b08a686cc6b353",
        "ngxCached": true,
        "ngxCachedTime": 1553263461,
        "title": "JavaScript"
    }],
    "title": "摩拜前端周刊第1期",
    "type": "post",
    "updatedAt": "2019-03-22T14:05:33.815Z",
    "user":
    {
        "avatarLarge": "https://user-gold-cdn.xitu.io/2018/7/5/16469a1a2e6c1450?w=400&h=400&f=png&s=63665",
        "collectedEntriesCount": 2,
        "community": null,
        "company": "摩拜",
        "followeesCount": 6,
        "followersCount": 482,
        "isAuthor": true,
        "jobTitle": "前端团队",
        "ngxCached": true,
        "ngxCachedTime": 1553263473,
        "objectId": "58b7ffe7128fe100642d8247",
        "postedEntriesCount": 0,
        "postedPostsCount": 2,
        "role": "editor",
        "subscribedTagsCount": 1,
        "totalCollectionsCount": 155,
        "totalCommentsCount": 35,
        "username": "摩拜单车前端团队",
        "viewedEntriesCount": 532
    },
    "verifyCreatedAt": "2019-03-22T09:39:08.828Z",
    "verifyStatus": true,
    "viewsCount": 1285
},
{
    "author": "",
    "autoPass": true,
    "buildTime": 1553263183.2455,
    "category":
    {
        "id": "5562b415e4b00c57d9b94ac8",
        "name": "前端",
        "ngxCached": true,
        "ngxCachedTime": 1553263447,
        "title": "frontend"
    },
    "checkStatus": true,
    "collectionCount": 8,
    "commentsCount": 0,
    "content": "本篇文章是 SQL 必知必会 的读书笔记，SQL必知必会的英文名叫做 Sams Teach Yourself in 10 Minutes 。但是，我肯定是不能够在10分钟就能学会本书所有涉及到的sql，所以就起个名字叫30分钟学会SQL语句（其实半个小时也没有学会...）。 目…",
    "createdAt": "2019-03-22T08:55:56.401Z",
    "english": false,
    "entryView": "",
    "gfw": false,
    "hot": false,
    "hotIndex": 289.183,
    "isCollected": false,
    "isEvent": false,
    "lastCommentTime": "1970-01-01T00:00:00.Z",
    "ngxCachedTime": 1553263538,
    "objectId": "5c94a31ce51d455212444037",
    "original": true,
    "originalUrl": "https://juejin.im/post/5c94a2e1f265da610762f713",
    "rankIndex": 11.022368554947,
    "screenshot": "",
    "subscribersCount": 0,
    "summaryInfo": "本篇文章是 SQL 必知必会 的读书笔记，SQL必知必会的英文名叫做 SAMS TEACH YOURSELF IN 10 MINUTES 。但是，我肯定是不能够在10分钟就能学会本书所有涉及到的sql，所以就起个名字叫30分钟学会SQL语句（其实半个小时也没有学会...）。 目前手边的数据库是 m...",
    "tags": [
    {
        "id": "555e9a8de4b00c57d9955eb9",
        "ngxCached": true,
        "ngxCachedTime": 1553263535,
        "title": "MySQL"
    },
    {
        "id": "582eca122e958a0069c6c71c",
        "ngxCached": true,
        "ngxCachedTime": 1553263501,
        "title": "SQL"
    }],
    "title": "30分钟SQL指南",
    "type": "post",
    "updatedAt": "2019-03-22T13:59:43.244Z",
    "user":
    {
        "avatarLarge": "https://leancloud-gold-cdn.xitu.io/bdfecd06f90e24f88946.jpeg?imageView/2/w/100/h/100/q/80/format/png",
        "collectedEntriesCount": 208,
        "community": null,
        "company": "",
        "followeesCount": 33,
        "followersCount": 4208,
        "isAuthor": false,
        "jobTitle": "",
        "ngxCached": true,
        "ngxCachedTime": 1553263484,
        "objectId": "56a34361816dfa005925a654",
        "postedEntriesCount": 47,
        "postedPostsCount": 13,
        "role": "editor",
        "subscribedTagsCount": 6,
        "totalCollectionsCount": 5385,
        "totalCommentsCount": 169,
        "username": "shanyue",
        "viewedEntriesCount": 4007
    },
    "verifyCreatedAt": "2019-03-22T08:55:56.401Z",
    "verifyStatus": true,
    "viewsCount": 207
},
{
    "author": "",
    "autoPass": false,
    "buildTime": 1553263422.0973,
    "category":
    {
        "id": "5562b415e4b00c57d9b94ac8",
        "name": "前端",
        "ngxCached": true,
        "ngxCachedTime": 1553263447,
        "title": "frontend"
    },
    "checkStatus": true,
    "collectionCount": 5,
    "commentsCount": 3,
    "content": "这篇文章不会大讲什么是函数式编程，为什么要使用函数式编程，而是开门见山，介绍函数式编程的最佳实践，希望大家读完了这篇文章，会理解函数式编程的美妙并且爱上它。 1. 纯函数 2. 一元函数（单参数） parseInt(x,radix）可以接受两个参数，因为第三个参数忽略，第一个参…",
    "createdAt": "2019-03-22T07:39:00.237Z",
    "english": false,
    "entryView": "",
    "gfw": false,
    "hot": false,
    "hotIndex": 333.0378,
    "isCollected": false,
    "isEvent": false,
    "lastCommentTime": "2019-03-22T19:36:21.916Z",
    "ngxCachedTime": 1553263538,
    "objectId": "5c948db66fb9a070d613926e",
    "original": true,
    "originalUrl": "https://juejin.im/post/5c8b485bf265da2d9c38b6e2",
    "rankIndex": 7.1845542729713,
    "screenshot": "",
    "subscribersCount": 0,
    "summaryInfo": "这篇文章不会大讲什么是函数式编程，为什么要使用函数式编程，而是开门见山，介绍函数式编程的最佳实践，希望大家读完了这篇文章，会理解函数式编程的美妙并且爱上它。 分析上面的代码，调用函数改变了函数外的变量y, 产生了副作用，因此不是纯函数 当一个函数引用了函数外的变量，也就是自由变量，并不是所有的自由...",
    "tags": [
    {
        "id": "584628f161ff4b006c3c147f",
        "ngxCached": true,
        "ngxCachedTime": 1553263536,
        "title": "函数式编程"
    }],
    "title": "函数式编程最佳实践",
    "type": "post",
    "updatedAt": "2019-03-22T14:03:42.095Z",
    "user":
    {
        "avatarLarge": "https://mirror-gold-cdn.xitu.io/168e097c23a296d9747",
        "collectedEntriesCount": 5,
        "community":
        {
            "wechat":
            {
                "avatarLarge": "http://thirdwx.qlogo.cn/mmopen/vi_32/gUhMa7CSLZxG7iaa82t37lHQK6xFMNH02W2AdF5jGibarkiajWz2ZplR2DfbCfLBT0Ix4gjDJxcPq8ctoxiciaiavOTA/132"
            }
        },
        "company": "",
        "followeesCount": 14,
        "followersCount": 4,
        "isAuthor": false,
        "jobTitle": "前端工程师",
        "ngxCached": true,
        "ngxCachedTime": 1553263487,
        "objectId": "5c282aa3e51d4535ef7789ac",
        "postedEntriesCount": 0,
        "postedPostsCount": 2,
        "role": "guest",
        "subscribedTagsCount": 41,
        "totalCollectionsCount": 7,
        "totalCommentsCount": 5,
        "username": "花开半夏爱学习",
        "viewedEntriesCount": 124
    },
    "verifyCreatedAt": "2019-03-22T07:39:00.237Z",
    "verifyStatus": true,
    "viewsCount": 266
},
{
    "author": "",
    "autoPass": false,
    "buildTime": 1553263247.4822,
    "category":
    {
        "id": "5562b415e4b00c57d9b94ac8",
        "name": "前端",
        "ngxCached": true,
        "ngxCachedTime": 1553263447,
        "title": "frontend"
    },
    "checkStatus": true,
    "collectionCount": 7,
    "commentsCount": 0,
    "content": "最近在试读vue的源码（vue3都要出来了，vue2的源码还没去读，惭愧惭愧），发现自己对观察者以及发布者-订阅者模式的理解不够，立文来梳理记录一下自己的思路。 有些人认为观察者模式 === 发布者-订阅者模式，也有人觉得两者存在一些区别，其实两者的确有一些区别，但是两者的目的…",
    "createdAt": "2019-03-22T07:38:47.941Z",
    "english": false,
    "entryView": "",
    "gfw": false,
    "hot": false,
    "hotIndex": 325.4161,
    "isCollected": false,
    "isEvent": false,
    "lastCommentTime": "1970-01-01T00:00:00.Z",
    "ngxCachedTime": 1553263538,
    "objectId": "5c948e11e51d4540632a1a02",
    "original": true,
    "originalUrl": "https://juejin.im/post/5c948cebe51d4508126c209f",
    "rankIndex": 7.0121333929372,
    "screenshot": "",
    "subscribersCount": 0,
    "summaryInfo": "最近在试读vue的源码（vue3都要出来了，vue2的源码还没去读，惭愧惭愧），发现自己对观察者以及发布者-订阅者模式的理解不够，立文来梳理记录一下自己的思路。 有些人认为观察者模式 === 发布者-订阅者模式，也有人觉得两者存在一些区别，其实两者的确有一些区别，但是两者的目的都是为了改善传统的通...",
    "tags": [
    {
        "id": "55a872f0e4b05881ac919dfc",
        "ngxCached": true,
        "ngxCachedTime": 1553263483,
        "title": "设计模式"
    }],
    "title": "对于观察者模式和发布者-订阅者模式的一些理解",
    "type": "post",
    "updatedAt": "2019-03-22T14:00:47.481Z",
    "user":
    {
        "avatarLarge": "https://mirror-gold-cdn.xitu.io/168e0881a098f79151f",
        "collectedEntriesCount": 30,
        "community":
        {
            "github":
            {
                "avatarLarge": "https://avatars1.githubusercontent.com/u/22521237?v=4",
                "uid": "22521237",
                "username": "polkYu"
            }
        },
        "company": "",
        "followeesCount": 1,
        "followersCount": 2,
        "isAuthor": false,
        "jobTitle": "",
        "ngxCached": true,
        "ngxCachedTime": 1553263430,
        "objectId": "59a8fe015188252445328667",
        "postedEntriesCount": 0,
        "postedPostsCount": 3,
        "role": "guest",
        "subscribedTagsCount": 21,
        "totalCollectionsCount": 7,
        "totalCommentsCount": 0,
        "username": "polkYu",
        "viewedEntriesCount": 262
    },
    "verifyCreatedAt": "2019-03-22T07:38:47.941Z",
    "verifyStatus": true,
    "viewsCount": 253
},
{
    "author": "",
    "autoPass": false,
    "buildTime": 1553263300.352,
    "category":
    {
        "id": "5562b415e4b00c57d9b94ac8",
        "name": "前端",
        "ngxCached": true,
        "ngxCachedTime": 1553263447,
        "title": "frontend"
    },
    "checkStatus": true,
    "collectionCount": 11,
    "commentsCount": 8,
    "content": "当然，这是很基础的 Webpack 配置，但本文介绍的是 IDE WebStorm 能够通过 Ctrl + 点击左键直接进入别名的某个目录下。WebStorm 默认是能够解析 webpack 配置文件的，也就是说你配置了 webpack 别名 alias 后，天生就支持这种快速…",
    "createdAt": "2019-03-22T07:14:43.523Z",
    "english": false,
    "entryView": "",
    "gfw": false,
    "hot": false,
    "hotIndex": 412.2872,
    "isCollected": false,
    "isEvent": false,
    "lastCommentTime": "2019-03-22T21:31:48.434Z",
    "ngxCachedTime": 1553263538,
    "objectId": "5c947c476fb9a070f90abbff",
    "original": true,
    "originalUrl": "https://juejin.im/post/5c9477ad6fb9a070ce31b050",
    "rankIndex": 8.1784523131054,
    "screenshot": "",
    "subscribersCount": 0,
    "summaryInfo": "我们使用 Webpack 经常会配置一些别名 指向特定的目录，这样在使用 等语句时就不用写一大堆的相对路径了，常见的是将项目的 设置为 ，比如某文件的路径是 ，配置后，任何地方就可以这样导入： 当然，这是很基础的 Webpack 配置，但本文介绍的是 IDE 能够通过 直接进入别名的某个目录下。W...",
    "tags": [
    {
        "id": "555e9a98e4b00c57d9955f68",
        "ngxCached": true,
        "ngxCachedTime": 1553263493,
        "title": "Vue.js"
    }],
    "title": "在 WebStorm 中，配置能够识别 Vue CLI 3 创建的项目的别名 alias @",
    "type": "post",
    "updatedAt": "2019-03-22T14:01:40.350Z",
    "user":
    {
        "avatarLarge": "https://user-gold-cdn.xitu.io/2019/1/9/16830fa6a6182d13?w=1920&h=1080&f=jpeg&s=1005812",
        "collectedEntriesCount": 60,
        "community":
        {
            "github":
            {
                "avatarLarge": "https://avatars3.githubusercontent.com/u/26299159?v=4",
                "uid": "26299159",
                "username": "dupingwei"
            },
            "wechat":
            {
                "avatarLarge": "http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJzmBzIeVHkjjqKDUgmKEMEsLdKWbqWS0fampPmjT5wQrAcjfmrprkk0BzNQw8CMFqmSDjaqRzQgQ/132"
            },
            "weibo":
            {
                "avatarLarge": "http://tva4.sinaimg.cn/crop.210.65.1137.1137.180/e4427893jw8eoanyk7k58j21kw0zk0y2.jpg",
                "blogAddress": "http://weibo.com/u/3829561491",
                "selfDescription": "淡然于人生，期待离去",
                "uid": "3829561491",
                "username": "杜萍伟"
            }
        },
        "company": "",
        "followeesCount": 4,
        "followersCount": 7,
        "isAuthor": false,
        "jobTitle": "咸鱼码农",
        "ngxCached": true,
        "ngxCachedTime": 1553263430,
        "objectId": "5a324d3af265da43163d1867",
        "postedEntriesCount": 0,
        "postedPostsCount": 18,
        "role": "guest",
        "subscribedTagsCount": 28,
        "totalCollectionsCount": 36,
        "totalCommentsCount": 8,
        "username": "杜萍伟",
        "viewedEntriesCount": 605
    },
    "verifyCreatedAt": "2019-03-22T07:14:43.523Z",
    "verifyStatus": true,
    "viewsCount": 260
}],
    cellWidth: 300,
    emptyData: {
      icon: 'iconshuju',
      text: '暂无详细数据',
      show: false,
      height: my.getSystemInfoSync().windowHeight
    },
    keywords: ["腾讯","二维码","日","妈逼"]
  },
  onLoad(query) {
    // 页面加载
    let that = this;
    // that.getData();
  },
  onReady() {
    // 页面加载完成
  },
  onShow() {
    // 页面显示
  },
  onHide() {
    // 页面隐藏
  },
  onUnload() {
    // 页面被关闭
  },
  onTitleClick() {
    // 标题被点击
  },
  onPullDownRefresh() {
    // 页面被下拉
  },
  onReachBottom() {
    // 页面被拉到底部
  },
  onShareAppMessage() {
    // 返回自定义分享信息
    return {
      title: 'My App',
      desc: 'My App description',
      path: 'pages/index/index',
    };
  },
  getData() {
    let that = this;
    let baseUrl = 'https://timeline-merger-ms.juejin.im';
    let param = {
      src: 'web',
      uid: '',
      device_id: '',
      token: '',
      limit: '6',
      category: '5562b415e4b00c57d9b94ac8'
    }
    let res = dataRequest(baseUrl, '/v1/get_entry_by_timeline', param);
    res.then(result => {
      let entrylist = [];
      result.d.entrylist.forEach(ele => {
        if (!!ele.original) {
          entrylist.push(ele);
        }
      })
      entrylist.forEach(ele => {
        ele.title = ele.title.replace(/['二维码'|'腾讯'|'妈逼'|'操']/g, '*')
      })
      console.log(JSON.stringify(entrylist))
      that.setData({
        entrylist,
        'emptyData.show': !!entrylist.length? false: true,
        cellWidth: my.getSystemInfoSync().windowWidth
      })
    }).catch(()=>{
      that.setData({
        'emptyData.show': true
      })
    })
  },
  toDetail(e) {
    let that = this;
    let url = e.target.dataset.originalUrl;
    let title = e.target.dataset.title;
    let id = url.split('/')[4];
    my.navigateTo({
      url: `/pages/juejin-detail/juejin-detail?objectId=${id}&title=${title}`
    })
  },
  refreshData() {
    let that = this;
    // that.getData();
  }
});
